{% extends 'polls/navigation.html' %}

{% block content %}
    <table class="table table-bordered" id="personTable">
        <thead class="table-green">
            <tr>
                <th>ID</th>
                <th>name</th>
                <th>age</th>
                <th data-sortable="true">score</th>
                <th>Edit</th>
            </tr>
        </thead>
        <tbody>
        {% for person in persons %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td class="editMe">{{ person.name }}</td>
                <td>{{ person.age }}</td>
                <td class="td-score">{{ person.score }}</td>
                <td><button id="btn{{ forloop.counter }}" class="btn">Edit</button></td>
{#                <td><input id="table+{{ forloop.counter }}" type="text" class="form-control" placeholder="Username" aria-label="Username" aria-describedby="basic-addon1"></td>#}
            </tr>
        {% endfor %}
        </tbody>
    </table>

<script>
    $(function() {
        $(".btn").click(function () {
            {#alert("click btn "+this.id)#}
            var name = $(this).parent().parent().children('td:eq(1)').text()
            var age = $(this).parent().siblings('td:eq(2)').text()
            alert("name: "+name)
            console.log(name)
            console.log(age)
            $.post("{% url 'polls:ajax_post' %}",
                {
                  name: name,
                  age: age,
                  csrfmiddlewaretoken: '{{ csrf_token }}',
                },
                function (data, status) {
                    alert(data)
                }
            )
        })
    })

    {% comment %}
    $(function () {
        // todo: make your own editable button
        var logAllEvents = true;
        //Basic editor with no navigation
        var simpleEditor = new SimpleTableCellEditor("personTable", {navigation:false});
        simpleEditor.SetEditableClass("editMe");
        $('#personTable').on("cell:edited", function (event) {
            var old_ = event.oldValue
            var new_ = event.newValue
            $.post("{% url 'polls:ajax_post' %}",
                {
                  old_: old_,
                  new_: new_,
                  csrfmiddlewaretoken: '{{ csrf_token }}',
                },
                function (data, status) {
                    alert(data)
                }
            )
            console.log(`'${event.oldValue}' changed to '${event.newValue}'`);
        })
    })
    {% endcomment %}

</script>
{% endblock %}

{#<!DOCTYPE html>#}
{#<html>#}
{#<head>#}
{#<meta charset="utf-8">#}
{#<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js">#}
{#</script>#}
{#<script>#}
{#$(document).ready(function(){#}
{#  $("#btn1").click(function(){#}
{#    alert("Text: " + $("#test").text());#}
{#  });#}
{#  $("#btn2").click(function(){#}
{#    alert("HTML: " + $("#test").html());#}
{#  });#}
{#  $("#btn3").click(function(){#}
{#    alert("Val: " + $("#test").val());#}
{#  });#}
{#  $("#btn4").click(function(){#}
{#    $.post("{% url 'polls:ajax_post' %}",#}
{#        {#}
{#            //post data#}
{#            //todo: use dynamic data#}
{#            'a': 1,#}
{#            'b': 2,#}
{#            'name': 'ffan',#}
{#        csrfmiddlewaretoken: '{{ csrf_token }}',#}
{#        },#}
{#        function (data, status) {#}
{#            console.log(status)#}
{#            console.log(data);#}
{#        })#}
{#  });#}
{#});#}
{#</script>#}
{#</head>#}
{##}
{#<body>#}
{#<p id="test">这是段落中的 <b>粗体</b> 文本。</p>#}
{#<button id="btn1" class="">显示文本</button>#}
{#<button id="btn2">显示 HTML</button>#}
{#<button id="btn3">显示 val</button>#}
{#<br>#}
{#<input type="text" class="form-control" placeholder="Username" aria-label="Username" aria-describedby="basic-addon1">#}
{#<button id="btn4">update</button>#}
{#</body>#}
{#</html>#}